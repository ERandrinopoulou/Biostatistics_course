---
title: "Biostatistics I: Introduction to R"
author: "Eleni-Rosalina Andrinopoulou"
institute: "Department of Biostatistics, Erasmus Medical Center"
email: "e.andrinopoulou@erasmusmc.nl"
twitter: "@erandrinopoulou"
output:
  beamer_presentation:
    template: mytemplate.latex
    includes:
      in_header: SlideTemplate.tex
    keep_tex: yes
    incremental: false
classoption: aspectratio=169
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Summary - Introduction

* **R** is a great tool to explore and investigate the data
* Several statistical methods can be performed with **R**
* It is important to understand the methods before applying them in **R**

\vspace*{0.9cm}

\begin{block}{How to use}
\textbf{R} uses packages that perform specific tasks
\begin{itemize}
\item Install package only once
\item Load package every time you open \textbf{R}
\end{itemize}
\end{block}




## Summary - Basics

\begin{columns}[onlytextwidth,T]
\begin{column}{0.30\linewidth}


\blue{Basic functions}
\begin{itemize}
\item \texttt{getwd()}, \texttt{setwd()}, 
\item \texttt{is.na()}, \texttt{is.finite()}, \texttt{is.null()}
\end{itemize}

\end{column}

\begin{column}{0.58\linewidth}


\blue{Import/Export}
\begin{itemize}
\item \texttt{read.csv()}, \texttt{write.csv()}
\item \texttt{read.xlsx()}, \texttt{write.xlsx()}
\item \texttt{read.table()}, \texttt{write.table()}
\end{itemize}

\bigskip

\blue{Save/Load}
\begin{itemize}
\item \texttt{save()}, \texttt{saveRDS()}
\item \texttt{load()}, \texttt{readRDS()}
\end{itemize}


\end{column}


\end{columns}



## Summary - Common Objects

\begin{columns}[onlytextwidth,T]
\begin{column}{0.30\linewidth}

\bigskip

\blue{Data types}
\begin{itemize}\vspace*{-0.5ex}
\item \texttt{numeric}
\item \texttt{character}
\item \texttt{integer}
\item \texttt{logical}
\item \texttt{factors}
\item \texttt{str()}, \texttt{mode()}
\end{itemize}

\end{column}

\begin{column}{0.58\linewidth}

\blue{Data structures}
\begin{itemize}\vspace*{-0.5ex}
\item \texttt{c()}
\item \texttt{matrix()}
\item \texttt{array()}
\item \texttt{data.frame()}
\item \texttt{list()}
\end{itemize}

\bigskip

\blue{Other}
\begin{itemize}
\item \texttt{ls()}, \texttt{objects()}
\end{itemize}

\end{column}
\end{columns}



## Summary - Indexing and Subsetting

\begin{columns}[onlytextwidth,T]
\begin{column}{0.5\linewidth}
\blue{Vectors}
\begin{itemize}\vspace*{-0.5ex}
\item \texttt{[]}
\item \texttt{[""]} - for categorical variables
\end{itemize}

\bigskip

\blue{Matrices}
\begin{itemize}
\item \texttt{[,]}
\item \texttt{[[]]}, \texttt{[]}
\end{itemize}

\bigskip

\blue{Arrays}
\begin{itemize}
\item \texttt{[ , , ]}
\end{itemize}
\end{column}


\begin{column}{0.5\linewidth}
\blue{Data frames}
\begin{itemize}
\item \texttt{[,]}
\item \texttt{[[]]}, \texttt{[]}
\item \texttt{\$}
\end{itemize}

\bigskip

\blue{Lists}
\begin{itemize}
\item \texttt{[]}
\item \texttt{[[]]}
\item \texttt{\$}
\end{itemize}


\end{column}

\end{columns}



## Summary - Data Transformation/Exploration/Visualization

\begin{columns}[onlytextwidth,T]
\begin{column}{0.30\linewidth}


\blue{Transformation}
\begin{itemize}\vspace*{-0.5ex}
\item \texttt{round()}
\item \texttt{factor()}
\item \texttt{order()}
\item \texttt{reshape()}
\end{itemize}
\end{column}

\begin{column}{0.30\linewidth}
\blue{Exploration}
\begin{itemize}\vspace*{-0.5ex}
\item \texttt{mean()}, \texttt{sd()}
\item \texttt{median()}, \texttt{IQR()}
\item \texttt{table()}
\end{itemize}
\end{column}

\begin{column}{0.30\linewidth}
\blue{Visualization}
\begin{itemize}
\item \texttt{plot()}, \texttt{legend()}
\item \texttt{hist()}
\item \texttt{barchart()}
\item \texttt{boxplot()}
\item \texttt{xyplot()}, \texttt{ggplot()}
\item \texttt{par()}
\end{itemize}
\end{column}

\end{columns}


## Summary - Correlation

- Pearson correlation: linear association 


\scriptsize \textcolor{EMC60}{A relationship is linear when a change in one variable is associated with a proportional change in the other variable}

\normalsize

-  Spearman correlation: monotonic relationship 


\scriptsize \textcolor{EMC60}{A relationship is monotonic if the variables tend to change together, but not always at a constant rate}

\


\begincols
  \begincol{0.3\textwidth}

\blue{Positive correlation}

\vspace*{-0.3cm}

```{r, echo = FALSE, cache = TRUE, message = FALSE, warning = FALSE, fig.height = 4, fig.width = 4}
library(MASS)
set.seed(2021+1)

r = 0.83
data = mvrnorm(n = 50, mu = c(0, 0), 
               Sigma = matrix(c(1, r, r, 1), nrow=2), 
               empirical = TRUE)
x = data[, 1]  
y = data[, 2]  
dat <- data.frame(x = x, y = y)

plot(x, y, pch = 16, xlab = "Variable 1", ylab = "Variable 2")
```

 \endcol
\begincol{0.3\linewidth}

\blue{Negative correlation}

\vspace*{-0.3cm}

```{r, echo = FALSE, cache = TRUE, message = FALSE, warning = FALSE, fig.height = 4, fig.width = 4}
library(MASS)
set.seed(2021+1)

r = -0.83
data = mvrnorm(n = 50, mu = c(0, 0), 
               Sigma = matrix(c(1, r, r, 1), nrow=2), 
               empirical = TRUE)
x = data[, 1]  
y = data[, 2]  
dat <- data.frame(x = x, y = y)

plot(x, y, pch = 16, xlab = "Variable 1", ylab = "Variable 2")
```

 \endcol
\begincol{0.3\linewidth}

\blue{No correlation}

\vspace*{-0.3cm}

```{r, echo = FALSE, cache = TRUE, message = FALSE, warning = FALSE, fig.height = 4, fig.width = 4}
library(MASS)
set.seed(2021+1)

r = 0.2
data = mvrnorm(n = 50, mu = c(0, 0), 
               Sigma = matrix(c(1, r, r, 1), nrow=2), 
               empirical = TRUE)
x = data[, 1]  
y = data[, 2]  
dat <- data.frame(x = x, y = y)

plot(x, y, pch = 16, xlab = "Variable 1", ylab = "Variable 2")
```     

 \endcol
\endcols


## Summary - Hypothesis Testing

\blue{Types of tests}

- Parametric / non-parametric
- one / two / M samples
- one-sided / two-sided


\blue{General procedure}

- Choose a null hypothesis $H_0$ and an alternative hypothesis $H_1$
- Collect and visualize the data
- Choose and calculate the test statistic, which is a numerical summary of the data
- Determine the sampling distribution under the condition that the null-hypothesis holds
- Choose the type I error (significant level) $\alpha$, usually $\alpha$=0.05
- Determine the corresponding critical value(s)
- Compare the test statistic with critical value(s) and reject or not
 
