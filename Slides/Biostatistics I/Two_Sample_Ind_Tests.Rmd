---
title: "Biostatistics I: Hypothesis testing"
subtitle: "Continuous data: Two-sample (independent) tests"
author: "Eleni-Rosalina Andrinopoulou"
institute: "Department of Biostatistics, Erasmus Medical Center"
email: "e.andrinopoulou@erasmusmc.nl"
twitter: "@erandrinopoulou"
output:
  beamer_presentation: 
    template: mytemplate.latex
    includes:
      in_header: SlideTemplate.tex
    keep_tex: yes
    incremental: false
classoption: aspectratio=169
---

  
```{r setup, include=FALSE}
def.chunk.hook  <- knitr::knit_hooks$get("chunk")
knitr::knit_hooks$set(chunk = function(x, options) {
  x <- def.chunk.hook(x, options)
  ifelse(options$size != "normalsize", paste0("\n \\", options$size,"\n\n", x, "\n\n \\normalsize"), x)
})


knitr::knit_hooks$set(
  nospace = function(before, options, envir) {
    if (before) {
      knitr::asis_output("\\vspace*{-1.5ex}")
    }
  }
)

knitr::opts_chunk$set(echo = FALSE, comment=NA)

library(survival)
library(knitr)
library(kableExtra)
library(dplyr)

pbc <- survival::pbc
pbcseq <- survival::pbcseq
```


## In this Section


* Two-sample t-test (independent samples)

* Two-sample Wilcoxon rank sum test (independent samples)

* Examples


 
## Two-sample t-test (independent samples): Theory   

\blue{Assumptions}

* The dependent variables must be continuous
* The observations are independent
* The dependent variables are approximately normally distributed
* The dependent variables do not contain any outliers



## Two-sample t-test (independent samples): Theory   

\blue{Scenario} 

Is the mean BMI of the students from group 1 different from the mean BMI of the students of group 2?


\blue{Connection with linear regression}

$y_i = \beta_0 + \beta_1x_i + \epsilon_i,$ \scriptsize where $x_i$ indicates whether a patient was in group 1 or in group 2
\normalsize
\newline\newline
$H_0: \beta_1 = 0$\newline
$H_1: \beta_1 \neq 0$



## Two-sample t-test (independent samples): Theory   

\blue{Scenario} 

Is the mean BMI of the students from group 1 different from the mean BMI of the students of group 2?


\blue{Alternatively}

$H_0: \mu_1 = \mu_2$\newline
$H_1: \mu_1 \neq \mu_2$




## Two-sample t-test (independent samples): Theory    

\begincols
  \begincol{0.5\textwidth}

```{r include = TRUE, cache = TRUE, warning = FALSE, eval = TRUE, fig.height=3, fig.width=4, dpi=272, dev='png'}
set.seed(2021)
x1 <- rnorm(50, 20, 5)
x2 <- rnorm(50, 20, 5)

id1 <- c(1:50)
id2 <- c(101:150)
dat <- data.frame(id = c(id1, id2), x = c(x1, x2))

library(ggplot2)
library(ggimage)

df_img <- data.frame(phase = c("Clipart"),
                     image = c("clipart.png"))
df_img$phase <- factor(df_img$phase, levels = df_img$phase)

ggplot(dat, aes(x = id, y = x)) +
  geom_segment(aes(x = 1, xend = 50, y = 20, yend = 20), 
               col = "#5379aa", lwd = 2) +
  geom_segment(aes(x = 101, xend = 150, y = 20, yend = 20), 
               col = rgb(0.6769,0.4447,0.7114), lwd = 2) +
  geom_image(aes(image = df_img$image), size = 0.02, col = "white") +
  labs(x = "", y = "BMI") + 
  theme(axis.text.x = element_blank(), 
        panel.background = element_rect(fill="grey30", colour="grey30"), 
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        axis.text.y=element_blank(), axis.ticks = element_blank()) +
  annotate(geom = "text", x = 30, y = 52, label = "Group 1",
              color = "white", cex = 6) +
  annotate(geom = "text", x = 115, y = 52, label = "Group 2",
              color = "white", cex = 6) +
  annotate(geom = "text", x = -8, y = 18, 
           label = expression(beta[0]),
              color = "white", cex = 4.5) +
  annotate(geom = "text", x = -8, y = 22, 
           label = expression(paste(mu[1], "=")),
              color = "white", cex = 4.5) +
  annotate(geom = "text", x = 89, y = 18, 
           label = expression(beta[0] + beta[1]),
              color = "white", cex = 4.5) + 
  annotate(geom = "text", x = 89, y = 22, 
           label = expression(paste(mu[2], "=")),
              color = "white", cex = 4.5) +
  geom_vline(xintercept = 72, col = "white", lwd = 1) +
  ylim(0, 54) +
  ggtitle("Null hypothesis")
```


\begin{itemize}
\item[] \hspace*{2.2cm} $\mu_1 = \mu_2$
\item[] \hspace*{2.2cm} $\beta_1 = 0$
\end{itemize}

 \endcol
\begincol{0.5\linewidth}

```{r include = TRUE, cache = TRUE, warning = FALSE, eval = TRUE, fig.height=3, fig.width=4, dpi=272, dev='png'}
set.seed(2021)
x1 <- rnorm(50, 20, 5)
x2 <- rnorm(50, 35, 5)

id1 <- c(1:50)
id2 <- c(101:150)
dat <- data.frame(id = c(id1, id2), x = c(x1, x2))

library(ggplot2)
library(ggimage)

df_img <- data.frame(phase = c("Clipart"),
                     image = c("clipart.png"))
df_img$phase <- factor(df_img$phase, levels = df_img$phase)

ggplot(dat, aes(x = id, y = x)) +
  geom_segment(aes(x = 1, xend = 50, y = 20, yend = 20), 
               col = "#5379aa", lwd = 2) +
  geom_segment(aes(x = 101, xend = 150, y = 35, yend = 35), 
               col = rgb(0.6769,0.4447,0.7114), lwd = 2) +
  geom_image(aes(image = df_img$image), size = 0.02, col = "white") +
  labs(x = "", y = "BMI") +
  theme(axis.text.x = element_blank(), 
        panel.background = element_rect(fill="grey30", colour="grey30"), 
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        axis.text.y=element_blank(), axis.ticks = element_blank()) +
  annotate(geom = "text", x = 30, y = 52, label = "Group 1",
              color = "white", cex = 6) +
  annotate(geom = "text", x = 115, y = 52, label = "Group 2",
              color = "white", cex = 6) +
  annotate(geom = "text", x = -8, y = 18, 
           label = expression(beta[0]),
              color = "white", cex = 4.5) +
  annotate(geom = "text", x = -8, y = 22, 
           label = expression(paste(mu[1], "=")),
              color = "white", cex = 4.5) +
  annotate(geom = "text", x = 89, y = 32, 
           label = expression(beta[0] + beta[1]),
              color = "white", cex = 4.5) +
  annotate(geom = "text", x = 89, y = 36, 
           label = expression(paste(mu[2], "=")),
              color = "white", cex = 4.5) +
  geom_vline(xintercept = 72, col = "white", lwd = 1) +
  ylim(0, 54) +
  ggtitle("Alternative hypothesis")
```

\begin{itemize}
\item[] \hspace*{2.2cm} $\mu_1 \neq \mu_2$
\item[] \hspace*{2.2cm} $\beta_1 \neq 0$
\end{itemize}

 \endcol
\endcols


## Two-sample t-test (independent samples): Theory     

\blue{Test statistic}

If the variances of the two groups are equal we use the t-statistic:

$t = \frac{(\bar{x}_1 - \bar{x}_2) - (\mu_1 - \mu_2)}{\sqrt{\frac{sd^2(x)}{n_1} + \frac{sd^2(x)}{n_2}}}$,
where

$sd^2(x) = \frac{\sum (x_1 - \bar{x}_1)^2 + \sum (x_2 - \bar{x}_2)^2}{n_1 + n_2 - 2}$

If the variances of the two groups being compared are _not_ equal we use the Welch t-statistic:

$t = \frac{(\bar{x}_1 - \bar{x}_2) - (\mu_1 - \mu_2)}{\sqrt{\frac{sd^2(x_1)}{n_1} + \frac{sd^2(x_2)}{n_2}}}$

- Sample mean of group 1, 2: $\bar{x}_1$, $\bar{x}_2$
- Standard deviation of group 1, 2: $sd(x_1)$, $sd(x_2)$
- Number of subjects in group 1, 2: $n_1$, $n_2$


## Two-sample t-test (independent samples): Theory     

\blue{Sampling distribution}

- $t$-distribution with:
  - If the variance of the two groups are equal: $df = n_1 + n_2 - 2$
  - If the variance of the two groups are _not_ equal: $df = \frac{\bigg[\frac{sd^2(x_1)}{n_1} + \frac{sd^2(x_2)}{n_2} \bigg]^2}{ \frac{[sd^2(x_1)/n_1]^2}{n_1 - 1} + \frac{[sd^2(x_2)/n_2]^2}{n_2 - 1} }$
- Critical values and p-value


\blue{Type I error}

- Normally $\alpha = 0.05$

\blue{Draw conclusions}

- Compare test statistic ($t$) with the critical values or the p-value with $\alpha$



## Two-sample t-test (independent samples): Application

\blue{Scenario} 

Is the mean BMI of the students from group 1 different from the mean BMI of the students of group 2?

\blue{Hypothesis}

$H_0: \mu_1 = \mu_2$\newline
$H_1: \mu_1 \neq \mu_2$


## Two-sample t-test (independent samples): Application

\blue{Collect and visualize data}

```{r, echo = FALSE, cache = TRUE, message = FALSE, warning = FALSE, fig.height=2.5, fig.width=4}
library(ggplot2)
library(gridExtra)
set.seed(2021+2)

BMI1 <- rnorm(50, 24, 6)
BMI2 <- rnorm(50, 23, 2)
id <- 1:50
df <- data.frame(id, BMI1, BMI2)

p1 <- ggplot(df, aes(x=BMI1)) + 
  geom_histogram(bins = 6, fill = rgb(0.6769,0.4447,0.7114)) +
  theme(panel.background = element_rect(fill="grey30", colour="grey30"), 
        panel.grid.major = element_blank(), panel.grid.minor = element_blank())

p2 <- ggplot(df, aes(x=BMI2)) + 
  geom_histogram(bins = 6, fill = rgb(0.6769,0.4447,0.7114)) +
  theme(panel.background = element_rect(fill="grey30", colour="grey30"), 
        panel.grid.major = element_blank(), panel.grid.minor = element_blank())

grid.arrange(p1, p2, nrow = 1)
```



## Two-sample t-test (independent samples): Application

\blue{Hypothesis}

$H_0: \mu_1 = \mu_2$\newline
$H_1: \mu_1 \neq \mu_2$\newline

\blue{Test statistic}

Let's assume that:

- Sample mean of group 1: $\bar{x}_1 = 24$
- Sample mean of group 2: $\bar{x}_2 = 23$
- Standard deviation of group 1: $sd(x_1) = 6$
- Standard deviation of group 2: $sd(x_2) = 2$
- Number of subjects in group 1: $n_1 = 50$
- Number of subjects in group 2: $n_2 = 50$


## Two-sample t-test (independent samples): Application 
 
\begin{tcolorbox}[colback=EMCdark,
                  colframe=EMCdark,
                  width=13cm
                 ]
{\color{white} 
 
We first test homogeneity of variances:\newline
$H_0: \frac{variance_1}{variance_2} = 1$\newline
$H_1: \frac{variance_1}{variance_2} \neq 1$\newline

$F$ statistic: $\frac{highest \ variance}{lowest \ variance} = 9$\newline\newline
DF: $n_1 - 1 = 50 - 1 = 49$, $n_2 - 1 = 50 - 1 = 49$\newline\newline
If $\alpha = 0.05$ and two-tailed test, get critical value in \texttt{R}:\newline
\texttt{qf(p = 0.05, df1 = 49, df2 = 49, lower.tail = FALSE)}\newline
\texttt{[1] 1.607289}\newline\newline
$\frac{highest \ variance}{lowest \ variance} = 9 > 1.61$ $\Rightarrow$ $H_0$ is rejected
}

\end{tcolorbox}
 

## Two-sample t-test (independent samples): Application  

\blue{Test statistic}

Not equal variances: 
 
$t = \frac{(\bar{x}_1 - \bar{x}_2) - (\mu_1 - \mu_2)}{\sqrt{\frac{sd^2(x_1)}{n_1} + \frac{sd^2(x_2)}{n_2}}} = \frac{24-23}{\sqrt{\frac{36}{50} + \frac{4}{50}}} = 1.12$


\blue{Degrees of freedom}

$df = \frac{\bigg[\frac{sd^2(x_1)}{n_1} + \frac{sd^2(x_2)}{n_2} \bigg]^2}{ \frac{[sd^2(x_1)/n_1]^2}{n_1 - 1} + \frac{[sd^2(x_2)/n_2]^2}{n_2 - 1} } = \frac{ \bigg( \frac{36}{50} + \frac{4}{50} \bigg)^2 }{ \frac{(36/50)^2}{49} + \frac{(4/50)^2}{49}  } =  59.76$

\blue{Type I error}

$\alpha = 0.05$



## Two-sample t-test (independent samples): Application  

\begincols
  \begincol{0.6\linewidth}

\blue{Critical values}

Using ```R``` we get the critical values from the $t$-distribution:\newline
critical value$_{\alpha/2}$ = critical value$_{0.05/2}$

```{r, echo = TRUE, cache = TRUE, message = FALSE, warning = FALSE, comment=""}
qt(p = 0.05/2, 59.76, lower.tail = FALSE)
```

-critical value$_{\alpha/2}$ = -critical value$_{0.05/2}$

```{r, echo = TRUE, cache = TRUE, message = FALSE, warning = FALSE, comment=""}
qt(p = 0.05/2, 59.76, lower.tail = TRUE)
```

 \endcol
\begincol{0.4\linewidth}

\textcolor{white}{texttestestesstdfgzdfgdfgdfgdsdfg}
```{r, echo = FALSE, cache = TRUE, message = FALSE, warning = FALSE, fig.height=2.5, fig.width=4}
library(ggplot2)
mu = 0
SD = 1
x <- rt(1000000, df = 5)
RI <- c(mu - 2 * SD, mu + 2 * SD)
meanX <- mean(x)

dat <- with(density(x), data.frame(x, y))
ggplot(data = dat, mapping = aes(x = x, y = y)) +
  geom_line(col = "white", lwd = 1) +
  geom_vline(aes(xintercept = meanX),
           color = "white", linetype = "dotted",  size = 1) +
  annotate(geom = "segment", x = 2, xend = 2, y = 0,
             yend = dt(2, df = 5),
             color = rgb(0.6769,0.4447,0.7114), lwd = 1.5) +
  labs(y="Density", x = "") +
  coord_cartesian(ylim = c(-0.003, 0.4), clip="off") +
  theme(panel.background = element_rect(fill="grey30", colour="grey30"), 
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),       
        axis.text.y=element_blank(), axis.ticks.y = element_blank()) +
  scale_x_continuous(breaks=c(RI[2]), limits = c(-3.5,3.5),
                     labels=c("2"))
```



```{r, echo = FALSE, cache = TRUE, message = FALSE, warning = FALSE, fig.height=2.5, fig.width=4}
library(ggplot2)
mu = 0
SD = 1
x <- rt(1000000, df = 5)
RI <- c(mu - 2 * SD, mu + 2 * SD)
meanX <- mean(x)

dat <- with(density(x), data.frame(x, y))
ggplot(data = dat, mapping = aes(x = x, y = y)) +
  geom_line(col = "white", lwd = 1) +
  geom_vline(aes(xintercept = meanX),
           color = "white", linetype = "dotted",  size = 1) +
  annotate(geom = "segment", x = -2, xend = -2, y = 0,
             yend = dt(2, df = 5),
             color = rgb(0.6769,0.4447,0.7114), lwd = 1.5) +
  labs(y="Density", x = "") +
  coord_cartesian(ylim = c(-0.003, 0.4), clip="off") +
  theme(panel.background = element_rect(fill="grey30", colour="grey30"), 
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),         
        axis.text.y=element_blank(), axis.ticks.y = element_blank()) +
  scale_x_continuous(breaks=c(RI[1]), limits = c(-3.5,3.5),
                     labels=c("-2"))
```

 \endcol
\endcols



## Two-sample t-test (independent samples): Application 

\blue{Draw conclusions}

We reject the $H_0$ if: 

- $t$ > critical value$_{\alpha/2}$ or $t$ < - critical value$_{\alpha/2}$

We have 1.12 < 2 $\Rightarrow$ we do not reject the $H_0$

\begincols
  \begincol{0.6\linewidth}
  
Using ```R``` we obtain the p-value from the $t$-distribution:


```{r, echo = TRUE, cache = TRUE, message = FALSE, warning = FALSE, comment = ""}
2 * pt(q = 1.12, df = 59.76, 
       lower.tail = FALSE)
```

 \endcol
\begincol{0.4\linewidth}

\vspace{0.6cm}

```{r, echo = FALSE, cache = TRUE, message = FALSE, warning = FALSE, fig.height=2.5, fig.width=4}
library(ggplot2)
mu = 0
SD = 1
x <- rnorm(1000000, mu, SD)
RI <- c(mu - 1.95 * SD, mu + 1.95 * SD)
meanX <- mean(x)

dat <- with(density(x), data.frame(x, y))
ggplot(data = dat, mapping = aes(x = x, y = y)) +
  geom_line(col = "white", lwd = 1) +
  geom_area(mapping = aes(x = ifelse(x >= RI[2] , x, 30)), 
            fill = rgb(0.6769,0.4447,0.7114)) +
  geom_area(mapping = aes(x = ifelse(x <= RI[1] , x, -30)), 
            fill = rgb(0.6769,0.4447,0.7114)) +
  geom_vline(aes(xintercept = meanX),
           color = "white", linetype = "dotted",  size = 1) +
  labs(y="Density", x = "") +
  annotate(geom = "text", x = 0, y = 0.1, label = "73%",
              color = "white", cex = 6) +
  annotate(geom = "text", x = -2.3, y = 0.01, label = "27/2%",
              color = "white", cex = 3) +
  annotate(geom = "text", x = 2.3, y = 0.01, label = "27/2%",
              color = "white", cex = 3) +
  coord_cartesian(ylim = c(-0.003, 0.4), clip="off") +
  theme(panel.background = element_rect(fill="grey30", colour="grey30"), 
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),         axis.text.y=element_blank(), axis.ticks.y = element_blank()) +
  scale_x_continuous(breaks=c(RI[1], RI[2]), limits = c(-3,3),
                     labels=c("-1.12", "1.12"))
```

 \endcol
\endcols








 
## Two-sample Wilcoxon rank sum test: Theory   

\blue{Assumptions}

* Population distribution is symmetric
* The observations are independent of one another


## Two-sample Wilcoxon rank sum test: Theory  

\blue{Scenario} 

Is the distribution of the score values of the students in group 1 different from the distribution of the score values of the students in group 2?


\blue{Connection with linear regression}

$rank(y_i) = \beta_0 + \beta_1x_i + \epsilon_i,$ 
\scriptsize where $x_i$ indicates whether a patient was in group 1 or in group 2 \normalsize

$H_0: \beta_1 = 0$\
$H_1: \beta_1 \neq 0$

\blue{Alternatively}

$H_0:$ the distributions of both populations are equal\newline
$H_1:$ the distributions are not equal


## Two-sample Wilcoxon rank sum test: Theory 

\blue{Test statistic}

- Calculate the ranks for the two groups ($r_1$ and $r_2$)
- Obtain the sum of those ranks $R_1=\sum r_1$, $R_2=\sum r_2$
- Calculate $U_1 = n_1n_2+ \frac{n_1(n_1+1)}{2}-R_1$ and $U_2 = n_1n_2+ \frac{n_2(n_2+1)}{2}-R_2$
- The test statistic ($U$) is the minimum of $U_1$ and $U_2$

\begin{tcolorbox}[colback=EMCdark,
                  colframe=EMCdark,
                  width=13cm
                 ]
{\color{white} 
If \textbf{one-tailed}: use either $U_1$ or $U_2$ for the test statistic ($U$) depending on the direction of the alternative hypothesis 
}
\end{tcolorbox}



## Two-sample Wilcoxon rank sum test: Theory 

\blue{Sampling distribution}

\textcolor{EMC60}{For large sample size:} we can use the normal approximation, that is, $W$ is normally distributed\newline
$\mu_U=\frac{n_1n_2}{2}$\newline
$\sigma_U = \sqrt{ \frac{n_1n_2(n_2 + n_1 + 1)}{12}}$\newline
If there are ties in ranks, we should use:\newline

$\sigma_u = \sqrt{ \frac{n_1n_2}{12}\bigg[(n+1) - \sum_{i=1}^K \frac{t_i^2-t_i}{n(n-1)}\bigg]}$\newline
where $n=n_1+n_2$ and $t_i$ is the number of subjects sharing the rank $i$. $K$ is the number of ranks\newline

$z = \frac{|min(U_1, U_2) - \mu_U| - 1/2}{\sigma_U}$\newline


## Two-sample Wilcoxon rank sum test: Theory 

\blue{Sampling distribution}

\textcolor{EMC60}{For small sample size:} we can use the exact distribution

- Get critical values and p-value

\blue{Type I error}

- Normally $\alpha = 0.05$


\blue{Draw conclusions}

- Compare test statistic with the critical values or the p-value with $\alpha$




## Two-sample Wilcoxon rank sum test: Application

\blue{Scenario} 

Is the distribution of the score values of the students in group 1 different from the distribution of the score values of the students in group 2?

\blue{Hypothesis}

$H_0:$ the distributions of both populations are equal\newline
$H_1:$ the distributions are not equal


## Two-sample Wilcoxon rank sum test: Application

\blue{Collect and visualize data}

```{r, echo = FALSE, cache = TRUE, message = FALSE, warning = FALSE}
set.seed(2021)
x <- rnorm(3, 10, 2)
y <- rnorm(3, 14, 2)

id <- c("x", "x", "x", "y", "y", "y")
value <- c(x, y)
res <- rank(c(x, y))

dat <- data.frame(variable = id, value = value, rank = res)
colnames(dat) <- c("variable", "value", "rank")

library(knitr)
kable(dat)
```

\vspace*{0.5cm}

\begincols
  \begincol{0.4\textwidth}
  
\blue{Hypothesis}

$H_0:$ the distributions of both populations are equal\newline
$H_1:$ the distributions are not equal \newline

\endcol
\begincol{0.5\linewidth}

\vspace*{-8cm}

\blue{Test statistic}

$R_1=1+4+3=8$ \newline
$U_1 = n_1n_2 + \frac{n_1(n_1+1)}{2} - R_1 = 7$ \newline
$R_2=5+6+2=13$ \newline
$U_2 = n_1n_2 + \frac{n_2(n_2+1)}{2} - R_2 = 2$ \newline

\blue{Type I error}

$\alpha = 0.05$

 \endcol
\endcols



## Two-sample Wilcoxon rank sum test: Application
  
\blue{Critical values}

Using ```R``` we get the critical values from the exact distribution:\newline
low critical value$_{\alpha/2}$ = low critical value$_{0.05/2}$

```{r, echo = TRUE, cache = TRUE, message = FALSE, warning = FALSE, comment=""}
qwilcox(p = 0.05/2, m = 3, n = 3, lower.tail = TRUE)
```

high critical value$_{\alpha/2}$ = high critical value$_{0.05/2}$

```{r, echo = TRUE, cache = TRUE, message = FALSE, warning = FALSE, comment=""}
qwilcox(p = 0.05/2, m = 3, n = 3, lower.tail = FALSE)
```



## Two-sample Wilcoxon rank sum test: Application

\blue{Draw conclusions}

We reject the $H_0$ if: 

- $U_1 >$ high critical value$_{\alpha/2}$ and $U_2 <$ low critical value$_{\alpha/2}$

We have $7 < 9$ and $2 > 0$ $\Rightarrow$ we do \textit{not} reject the $H_0$


## Two-sample Wilcoxon rank sum test: Application

\blue{Draw conclusions}

Using ```R``` we obtain the p-value from the exact distribution:

$p-value = 2 * Pr(U <= 2):$\
```{r, echo = TRUE, cache = TRUE, message = FALSE, warning = FALSE, comment = ""}
2 * pwilcox(q = 2, m = 3, n = 3, lower.tail = TRUE) 
```

or 

$p-value = 2 * Pr(U >= 7) = 2 * (1 - Pr(U < 7)):$
```{r, echo = TRUE, cache = TRUE, message = FALSE, warning = FALSE, comment = ""}
2 * (1 - pwilcox(q = 7 - 1, m = 3, n = 3, lower.tail = TRUE))
2 * pwilcox(q = 7 - 1, m = 3, n = 3, lower.tail = FALSE)
```
